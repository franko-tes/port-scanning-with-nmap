# 04.1 DetecciÃ³n de Sistema Operativo con Nmap

ğŸ“– **Consulta la teorÃ­a antes de comenzar:**  
ğŸ”— [04. DetecciÃ³n de Sistema Operativo en Nmap](https://courageous-tail-945.notion.site/04-Deteccion-de-Sistema-Operativo-en-Nmap)


## Ejecutar un escaneo de sistema operativo

El escaneo de sistema operativo con **Nmap** utiliza la opciÃ³n `-O` para analizar las caracterÃ­sticas de la pila TCP/IP y determinar quÃ© sistema operativo estÃ¡ en ejecuciÃ³n.

Para realizar este escaneo en **Windows (PowerShell)**:  
`nmap -O <IP_DEL_OBJETIVO>`

ğŸ“Œ **Ejemplo con una IP local:**  
`nmap -O 192.168.1.1`

ğŸ“Œ **Posible salida del comando:**
> Starting Nmap 7.94 ( https://nmap.org ) at 2025-02-20 16:30  
> Nmap scan report for 192.168.1.1  
> Host is up (0.0025s latency).  
> Not shown: 998 closed ports  
> PORT    STATE SERVICE  
> 22/tcp  open  ssh  
> 80/tcp  open  http  
> Device type: general purpose  
> Running: Linux 5.X  
> OS CPE: cpe:/o:linux:linux_kernel:5  
> OS details: Linux 5.0 - 5.4  

ğŸ“ **AnÃ¡lisis:**
- `Running: Linux 5.X` â†’ Indica que el sistema operativo detectado es **Linux**, con kernel entre **5.0 y 5.4**.  
- `Device type: general purpose` â†’ Sugiere que es un equipo de uso general (PC o servidor).  
- `OS CPE: cpe:/o:linux:linux_kernel:5` â†’ IdentificaciÃ³n estandarizada del sistema.

---

## Â¿QuÃ© hace este comando?

âœ… `-O` â†’ Activa la detecciÃ³n de sistema operativo, enviando paquetes especÃ­ficos y comparando las respuestas con la base de datos interna de **Nmap**.

âš ï¸ **Limitaciones:**
âŒ Puede fallar si el firewall bloquea los paquetes de prueba.  
âŒ Algunos sistemas pueden devolver firmas ambiguas o incompletas.  
âŒ No siempre se obtiene la versiÃ³n exacta del SO, sino una aproximaciÃ³n.

---

## SoluciÃ³n de problemas

ğŸ”¹ **Error: "OS detection requires root privileges"**  
ğŸ“Œ **Posible causa:** En algunos sistemas, la detecciÃ³n de SO requiere permisos elevados.  
ğŸ“Œ **SoluciÃ³n:** Abre **PowerShell como Administrador** en Windows o utiliza `sudo` en Linux.  
- En Windows:  
  `nmap -O <IP_DEL_OBJETIVO>`  
- En Linux:  
  `sudo nmap -O <IP_DEL_OBJETIVO>`

ğŸ”¹ **Error: "No exact OS matches for host"**  
ğŸ“Œ **Posible causa:** Nmap no pudo identificar con precisiÃ³n el sistema operativo.  
ğŸ“Œ **SoluciÃ³n:**  
1. **Intentar con** `--osscan-guess` para mejorar la precisiÃ³n:  
   `nmap -O --osscan-guess <IP_DEL_OBJETIVO>`  
2. **Verificar si hay firewalls** que estÃ©n bloqueando las respuestas.

